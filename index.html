<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Glow-Pop | Neon Slasher</title>
    <style>
        body { margin: 0; overflow: hidden; background: #0a0a0a; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; touch-action: none; }
        
        #ui {
            position: absolute; top: 20px; left: 20px; color: #bc13fe;
            pointer-events: none; text-shadow: 0 0 10px #bc13fe;
            font-size: 24px; font-weight: bold;
        }

        #overlay {
            position: absolute; inset: 0; background: rgba(0,0,0,0.85);
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; z-index: 10; color: white; text-align: center;
        }

        .btn {
            background: #bc13fe; color: white; border: none; padding: 15px 40px;
            font-size: 20px; border-radius: 5px; cursor: pointer; margin-top: 20px;
            box-shadow: 0 0 15px #bc13fe; transition: 0.2s;
        }
        .btn:hover { transform: scale(1.1); box-shadow: 0 0 25px #bc13fe; }

        .kiss { font-size: 100px; animation: pulse 0.8s infinite; }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="ui">SCORE: <span id="score">0</span></div>

<div id="overlay">
    <h1 style="font-size: 45px; margin: 0; letter-spacing: 5px;">GLOW-POP</h1>
    <p>Swipe to slash the Purple Orbs! Avoid the Red Bombs!</p>
    <button class="btn" onclick="startGame()">START SLASHING</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const overlay = document.getElementById('overlay');

let gameActive = false;
let score = 0;
let targets = [];
let particles = [];
let bladeTrail = [];
const winGoal = 3000;

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// Input Tracking
let isDrawing = false;
const handleMove = (e) => {
    if (!gameActive) return;
    const x = e.touches ? e.touches[0].clientX : e.clientX;
    const y = e.touches ? e.touches[0].clientY : e.clientY;
    
    if (isDrawing) {
        bladeTrail.push({ x, y, life: 10 });
        checkSlash(x, y);
    }
};

window.addEventListener('mousedown', () => isDrawing = true);
window.addEventListener('mouseup', () => { isDrawing = false; bladeTrail = []; });
window.addEventListener('mousemove', handleMove);
window.addEventListener('touchstart', (e) => { isDrawing = true; handleMove(e); });
window.addEventListener('touchend', () => { isDrawing = false; bladeTrail = []; });
window.addEventListener('touchmove', (e) => { e.preventDefault(); handleMove(e); }, {passive: false});

function spawnTarget() {
    if (!gameActive) return;
    const isBomb = Math.random() < 0.2;
    targets.push({
        x: Math.random() * (canvas.width - 100) + 50,
        y: canvas.height + 50,
        vx: (Math.random() - 0.5) * 4,
        vy: -(Math.random() * 5 + 12),
        radius: isBomb ? 25 : 35,
        isBomb: isBomb,
        angle: 0,
        rotation: (Math.random() - 0.5) * 0.2
    });
    setTimeout(spawnTarget, Math.max(400, 1000 - (score/10)));
}

function checkSlash(sx, sy) {
    targets.forEach((t, i) => {
        const dist = Math.hypot(sx - t.x, sy - t.y);
        if (dist < t.radius) {
            if (t.isBomb) {
                gameOver();
            } else {
                popTarget(t, i);
            }
        }
    });
}

function popTarget(t, index) {
    score += 100;
    scoreEl.innerText = score;
    // Create Explosion Particles
    for (let i = 0; i < 12; i++) {
        particles.push({
            x: t.x, y: t.y,
            vx: (Math.random() - 0.5) * 10,
            vy: (Math.random() - 0.5) * 10,
            life: 1.0,
            color: '#bc13fe'
        });
    }
    targets.splice(index, 1);
    if (score >= winGoal) winGame();
}

function startGame() {
    score = 0; targets = []; particles = []; bladeTrail = [];
    scoreEl.innerText = score;
    gameActive = true;
    overlay.style.display = 'none';
    spawnTarget();
}

function update() {
    if (!gameActive) return;

    targets.forEach((t, i) => {
        t.x += t.vx;
        t.y += t.vy;
        t.vy += 0.2; // Gravity
        t.angle += t.rotation;
        if (t.y > canvas.height + 100) targets.splice(i, 1);
    });

    particles.forEach((p, i) => {
        p.x += p.vx; p.y += p.vy; p.life -= 0.02;
        if (p.life <= 0) particles.splice(i, 1);
    });

    bladeTrail.forEach((b, i) => {
        b.life--;
        if (b.life <= 0) bladeTrail.splice(i, 1);
    });
}

function draw() {
    ctx.fillStyle = 'rgba(10, 10, 10, 0.4)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Draw Blade
    if (bladeTrail.length > 1) {
        ctx.beginPath();
        ctx.strokeStyle = 'white';
        ctx.lineWidth = 4;
        ctx.lineJoin = 'round';
        ctx.moveTo(bladeTrail[0].x, bladeTrail[0].y);
        for (let i = 1; i < bladeTrail.length; i++) {
            ctx.lineTo(bladeTrail[i].x, bladeTrail[i].y);
        }
        ctx.shadowBlur = 15;
        ctx.shadowColor = '#bc13fe';
        ctx.stroke();
        ctx.shadowBlur = 0;
    }

    // Draw Targets
    targets.forEach(t => {
        ctx.save();
        ctx.translate(t.x, t.y);
        ctx.rotate(t.angle);
        if (t.isBomb) {
            ctx.fillStyle = '#ff0000';
            ctx.beginPath();
            ctx.moveTo(0, -t.radius);
            ctx.lineTo(t.radius, t.radius);
            ctx.lineTo(-t.radius, t.radius);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = 'black';
            ctx.fillText('âš¡', -8, 15);
        } else {
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#bc13fe';
            ctx.fillStyle = '#bc13fe';
            ctx.beginPath();
            ctx.arc(0, 0, t.radius, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'white';
            ctx.font = '20px Arial';
            ctx.fillText('ðŸ’Ž', -10, 7);
        }
        ctx.restore();
    });

    // Draw Particles
    particles.forEach(p => {
        ctx.globalAlpha = p.life;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
        ctx.fill();
    });
    ctx.globalAlpha = 1;
}

function gameOver() {
    gameActive = false;
    overlay.style.display = 'flex';
    overlay.innerHTML = `<h1>VOID BOMB DETONATED</h1><p>Score: ${score}</p><button class="btn" onclick="startGame()">REBOOT</button>`;
}

function winGame() {
    gameActive = false;
    overlay.style.display = 'flex';
    overlay.innerHTML = `
        <h1 style="color: #bc13fe;">NEON MASTER!</h1>
        <div class="kiss">ðŸ’‹</div>
        <p>Perfect Slicing! Here is your reward!</p>
        <button class="btn" onclick="startGame()">PLAY AGAIN</button>
    `;
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>