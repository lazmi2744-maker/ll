<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Catch Ana: Heart Seeker</title>
    <style>
        body { margin: 0; overflow: hidden; background: #2c003e; font-family: 'Comic Sans MS', cursive, sans-serif; }
        canvas { display: block; touch-action: none; cursor: crosshair; }
        
        #ui {
            position: absolute; top: 15px; left: 15px; color: #f0abfc;
            pointer-events: none; text-shadow: 2px 2px 5px #000;
            font-size: 22px; z-index: 5;
        }

        #overlay {
            position: absolute; inset: 0; background: rgba(44, 0, 62, 0.9);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 10; color: white; text-align: center; padding: 20px;
        }

        .btn {
            background: #a21caf; color: white; border: 3px solid #f0abfc;
            padding: 15px 40px; font-size: 22px; border-radius: 50px;
            cursor: pointer; margin-top: 20px; box-shadow: 0 0 15px #f0abfc;
        }

        .smooch { font-size: 100px; animation: heartBeat 0.6s infinite; }
        @keyframes heartBeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="ui">
    <div>CATCHES: <span id="score">0</span> / 50</div>
    <div>HEARTS: <span id="lives">‚ù§‚ù§‚ù§</span></div>
</div>

<div id="overlay">
    <h1 style="font-size: 45px; color: #f0abfc; margin: 0;">CATCH ANA</h1>
    <p>Ana the Cat is hiding! Tap her before she teleports.<br>Avoid the Shadow Ravens!</p>
    <button class="btn" onclick="startGame()">START HUNT</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const livesEl = document.getElementById('lives');
const overlay = document.getElementById('overlay');

let gameActive = false;
let score = 0;
let lives = 3;
let ana = { x: 0, y: 0, size: 60, active: false, timer: 0 };
let traps = [];
let particles = [];
let nextSpawn = 0;

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// Click/Touch Handler
const handleInput = (e) => {
    if (!gameActive) return;
    const x = e.touches ? e.touches[0].clientX : e.clientX;
    const y = e.touches ? e.touches[0].clientY : e.clientY;

    // Check Ana hit
    if (ana.active) {
        const dist = Math.hypot(x - ana.x, y - ana.y);
        if (dist < ana.size) {
            catchAna();
            return;
        }
    }

    // Check Trap hit
    traps.forEach((t, i) => {
        const dist = Math.hypot(x - t.x, y - t.y);
        if (dist < 30) {
            hitTrap(i);
        }
    });
};

canvas.addEventListener('mousedown', handleInput);
canvas.addEventListener('touchstart', (e) => { e.preventDefault(); handleInput(e); });

function startGame() {
    score = 0; lives = 3; traps = []; particles = [];
    scoreEl.innerText = score;
    livesEl.innerText = "‚ù§‚ù§‚ù§";
    gameActive = true;
    overlay.style.display = 'none';
    spawnAna();
}

function spawnAna() {
    if (!gameActive) return;
    ana.x = Math.random() * (canvas.width - 100) + 50;
    ana.y = Math.random() * (canvas.height - 100) + 50;
    ana.active = true;
    ana.timer = Math.max(600, 1200 - (score * 10)); // Gets faster!
    
    // Chance to spawn a shadow raven
    if (Math.random() > 0.5) {
        traps.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            life: 2000
        });
    }
}

function catchAna() {
    score++;
    scoreEl.innerText = score;
    ana.active = false;
    createExplosion(ana.x, ana.y, '#f0abfc');
    
    if (score >= 50) winGame();
    else setTimeout(spawnAna, 300);
}

function hitTrap(index) {
    lives--;
    livesEl.innerText = "‚ù§".repeat(lives);
    createExplosion(traps[index].x, traps[index].y, '#000');
    traps.splice(index, 1);
    if (lives <= 0) gameOver();
}

function createExplosion(x, y, color) {
    for (let i = 0; i < 10; i++) {
        particles.push({
            x, y,
            vx: (Math.random() - 0.5) * 10,
            vy: (Math.random() - 0.5) * 10,
            life: 1.0,
            color
        });
    }
}

function update() {
    if (!gameActive) return;

    if (ana.active) {
        ana.timer -= 16;
        if (ana.timer <= 0) {
            ana.active = false;
            setTimeout(spawnAna, 200);
        }
    }

    traps.forEach((t, i) => {
        t.life -= 16;
        if (t.life <= 0) traps.splice(i, 1);
    });

    particles.forEach((p, i) => {
        p.x += p.vx; p.y += p.vy; p.life -= 0.02;
        if (p.life <= 0) particles.splice(i, 1);
    });
}

function draw() {
    // Deep purple background
    ctx.fillStyle = '#2c003e';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Background Stars
    ctx.fillStyle = 'rgba(255,255,255,0.2)';
    for(let i=0; i<20; i++) ctx.fillRect((i*137)%canvas.width, (i*251)%canvas.height, 2, 2);

    if (!gameActive) return;

    // Draw Traps (Ravens)
    traps.forEach(t => {
        ctx.font = '40px Arial';
        ctx.fillText('üê¶‚Äç‚¨õ', t.x - 20, t.y + 15);
    });

    // Draw Ana (The Cat)
    if (ana.active) {
        ctx.shadowBlur = 20;
        ctx.shadowColor = '#f0abfc';
        ctx.font = '60px Arial';
        ctx.fillText('üê±', ana.x - 30, ana.y + 25);
        ctx.shadowBlur = 0;
    }

    // Draw Particles
    particles.forEach(p => {
        ctx.globalAlpha = p.life;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
        ctx.fill();
    });
    ctx.globalAlpha = 1;
}

function gameOver() {
    gameActive = false;
    overlay.style.display = 'flex';
    overlay.innerHTML = `<h1>ANA GOT AWAY!</h1><p>Catches: ${score}</p><button class="btn" onclick="startGame()">TRY AGAIN</button>`;
}

function winGame() {
    gameActive = false;
    overlay.style.display = 'flex';
    overlay.innerHTML = `
        <h1 style="color: #f0abfc;">YOU CAUGHT ANA!</h1>
        <div class="smooch">üíã</div>
        <p>She loves her new friend! Here is your reward!</p>
        <button class="btn" onclick="startGame()">PLAY AGAIN</button>
    `;
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
